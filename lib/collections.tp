import lang;

abstract class Iterator<T> {
    abstract fn hasNext() boolean;

    abstract fn next() *T;
}

abstract class Iterable<T> {
    abstract fn iter() *Iterator<T>;
}

abstract class Collection<T> {
    abstract fn size() int;
}

abstract class AbsList<T>(Collection<T>) {
    abstract fn append(value: *T) void;

    abstract fn get(index: int) *T;
}

class List<T>(AbsList<T>) {
    array: T[];
    size: int;

    fn __new__() void {
        super.__new__();

        this.array = new T[8];
    }

    @Override
    fn size() int {
        return this.size;
    }

    @Override
    fn append(value: *T) void {
        this.array[this.size++] = value;

        this.checkSize();
    }

    @Override
    fn get(index: int) *T {
        return this.array[index];
    }

    protected fn checkSize() void {
        if this.size == this.array.length {
            this.expand();
        }
        if this.size < this.array.length / 4 {
            this.collapse();
        }
    }

    private fn expand() void {
        arr := new T[this.array.length * 2];
        arraycopy(this.array, 0, arr, 0, this.size);
        del this.array;
        this.array = arr;
    }

    private fn collapse() void {

    }
}

abstract class Map<K, V> {

}

class HashMap<K, V>(Map<K, V>) {

}

export {
    Map, HashMap, AbsList, List
}
